role: "You are an elite AI Scientist specializing in Graph Neural Networks for Molecular Discovery and a Senior Python Software Architect obsessed with code stability and interface compliance."

objective: |
  I need you to implement a new molecular prediction model into my existing `torch_molecule` framework.

  1. The Innovation (Science):
     You must design a model named **[INSERT_MODEL_NAME_HERE]**.
       * Core Idea: "[INSERT_YOUR_NEW_ALGORITHM_IDEA_HERE, e.g., A Mamba-based GNN that linearizes graphs to capture long-range dependencies using State Space Models]"

  2. The Constraints (Engineering):
     You must strictly follow the engineering structure of the Golden Template provided below.
     DO NOT simplify, refactor, or modernize the engineering logic.

golden_template: |
  ```python
  # [PASTE THE CONTENT OF YOUR FIXED modeling_equiformer.py HERE]
  ```
  (Treat the code above as the absolute source of truth for class structure, logging,
  progress bars, and optimization loops. Only modify model-specific logic.)

requirements:
  file_structure:
    - "model.py: Implement the new [ModelName]Model class (nn.Module). Use native PyTorch primitives as much as possible."
    - "modeling_[model_name_lowercase].py: Implement the [ModelName]MolecularPredictor class."

  strict_interface_compliance:
    init:
      must_accept: "**kwargs and all hyperparameters required for autofit."
    convert_to_pytorch_data: |
      - If the new model requires 3D coordinates, keep rdkit embedding logic with try-except exactly as in the template.
      - If only 2D topology is needed, adapt standard GNN logic but keep the function signature identical.

    training_loops:
      constraints:
        - "Must implement `_train_epoch` and `_evaluation_epoch`."
        - "Must preserve tqdm progress bar with `set_postfix` exactly as in the template."
        - "No replacement with print statements."

    autofit:
      signature: "def autofit(self, X_train, y_train, X_val=None, y_val=None, **kwargs):"
      constraints:
        - "Never use *args or positional argument tricks."
        - "Must retain full Optuna optimization logic."

    get_model_params:
      must_accept: "(self, checkpoint=None)"
      must_return: "Dictionary of parameters needed to re-initialize the model."

output:
  description: "Provide full, unsimplified code for both model.py and modeling_[name].py."
  requirement: "Do not use placeholders like ... for engineering sections."

notes: |
  This YAML file encodes the entire instruction block in a fully parseable form.
